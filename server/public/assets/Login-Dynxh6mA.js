import{j as e,r as C,u as U,b as F,S as V,V as q,_ as s,a as I,s as W,c as S}from"./index-D5nzqchR.js";import{i as A,u as x,a as D}from"./index-BzEcBDfL.js";import{C as k}from"./Container-B4NxncJo.js";import{P as B}from"./Modal-B4RS4siC.js";import{c as M,T as o}from"./Typography-1nQW5jSD.js";import{T as l}from"./TextField-BCeHNm3V.js";import{B as v}from"./Button-B8ILfpcq.js";import{A as P}from"./Avatar-DtbMtKou.js";import{M as E}from"./IconButton-D_lXahTx.js";import"./isMuiElement-DRgL1YLt.js";import"./Menu-B5zeCvBD.js";const R=M([e.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),e.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"CameraAlt"),O=f=>{if(!A(f))return{isValid:!1,errorMessage:"Username is Invalid"}},ee=()=>{const[f,L]=C.useState(!0),[g,p]=C.useState(!1),y=()=>L(c=>!c),j=x(""),b=x(""),r=x("",O),t=x(""),d=D("single"),w=U(),H=async c=>{var h,m;c.preventDefault();const u=s.loading("Logging In...");p(!0);const n={withCredentials:!0,headers:{"Content-Type":"application/json"}};try{const{data:a}=await I.post(`${W}/api/v1/user/login`,{username:r.value,password:t.value},n);w(S(a.user)),s.success(a.message,{id:u})}catch(a){s.error(((m=(h=a==null?void 0:a.response)==null?void 0:h.data)==null?void 0:m.message)||"Something Went Wrong",{id:u})}finally{p(!1)}},T=async c=>{var m,a;c.preventDefault();const u=s.loading("Signing Up...");p(!0);const n=new FormData;n.append("avatar",d.file),n.append("name",j.value),n.append("bio",b.value),n.append("username",r.value),n.append("password",t.value);const h={withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}};try{const{data:i}=await I.post(`${W}/api/v1/user/new`,n,h);w(S(i.user)),s.success(i.message,{id:u})}catch(i){s.error(((a=(m=i==null?void 0:i.response)==null?void 0:m.data)==null?void 0:a.message)||"Something Went Wrong",{id:u})}finally{p(!1)}};return e.jsx("div",{style:{backgroundImage:F},children:e.jsx(k,{component:"main",maxWidth:"xs",sx:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(B,{elevation:3,sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center"},children:f?e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"h5",children:"Login"}),e.jsxs("form",{style:{width:"100%",marginTop:"1rem"},onSubmit:H,children:[e.jsx(l,{required:!0,fullWidth:!0,label:"Username",margin:"normal",variant:"outlined",value:r.value,onChange:r.changeHandler}),e.jsx(l,{required:!0,fullWidth:!0,label:"Password",type:"password",margin:"normal",variant:"outlined",value:t.value,onChange:t.changeHandler}),e.jsx(v,{sx:{marginTop:"1rem"},variant:"contained",color:"primary",type:"submit",fullWidth:!0,disabled:g,children:"Login"}),e.jsx(o,{textAlign:"center",m:"1rem",children:"OR"}),e.jsx(v,{disabled:g,fullWidth:!0,variant:"text",onClick:y,children:"Sign Up Instead"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"h5",children:"Sign Up"}),e.jsxs("form",{style:{width:"100%",marginTop:"1rem"},onSubmit:T,children:[e.jsxs(V,{position:"relative",width:"10rem",margin:"auto",children:[e.jsx(P,{sx:{width:"10rem",height:"10rem",objectFit:"contain"},src:d.preview}),e.jsx(E,{sx:{position:"absolute",bottom:"0",right:"0",color:"white",bgcolor:"rgba(0,0,0,0.5)",":hover":{bgcolor:"rgba(0,0,0,0.7)"}},component:"label",children:e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx(q,{type:"file",onChange:d.changeHandler})]})})]}),d.error&&e.jsx(o,{m:"1rem auto",width:"fit-content",display:"block",color:"error",variant:"caption",children:d.error}),e.jsx(l,{required:!0,fullWidth:!0,label:"Name",margin:"normal",variant:"outlined",value:j.value,onChange:j.changeHandler}),e.jsx(l,{required:!0,fullWidth:!0,label:"Bio",margin:"normal",variant:"outlined",value:b.value,onChange:b.changeHandler}),e.jsx(l,{required:!0,fullWidth:!0,label:"Username",margin:"normal",variant:"outlined",value:r.value,onChange:r.changeHandler}),r.error&&e.jsx(o,{color:"error",variant:"caption",children:r.error}),e.jsx(l,{required:!0,fullWidth:!0,label:"Password",type:"password",margin:"normal",variant:"outlined",value:t.value,onChange:t.changeHandler}),e.jsx(v,{sx:{marginTop:"1rem"},variant:"contained",color:"primary",type:"submit",fullWidth:!0,disabled:g,children:"Sign Up"}),e.jsx(o,{textAlign:"center",m:"1rem",children:"OR"}),e.jsx(v,{disabled:g,fullWidth:!0,variant:"text",onClick:y,children:"Login Instead"})]})]})})})})};export{ee as default};
